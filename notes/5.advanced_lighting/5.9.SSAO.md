# 屏幕空间环境遮蔽

环境遮蔽一般用于削减 ambient 项的强度，来实现物体在接缝和内凹处的暗部效果。

朴素的 AO 通过基于几何信息的射线测试或采样点测试来实现，而 SSAO 利用屏幕空间的深度缓冲来计算遮蔽因子（occlusion factor）。

球形采样计算出的遮蔽因子一般会大于法向量对齐的半球采样，因为对于平面来说球形有一半的区域是“被遮蔽的”。

注意计算 SSAO 时是在 view 空间下（相应地注意 g-pass 时对法向量的变换），结束后需要映射到投影空间。在 view 空间下计算也会有一些问题，例如在视线方向接近但是纵深相差很大的两个片段，就不应该被用于计算遮蔽因子，需要使用基于距离的剔除等方法排除掉，即使这样还是会和严格基于几何信息计算的 AO 有差别。

相较于实时计算 SSAO，提前把 AO 烘焙成贴图会更方便。