# 5.2 伽马

有很多不同的思路来解释伽马、伽马校正和伽马编码，大都和人眼、CRT 显示器有关。以下内容更像是尝试把这些东西拼在一起。

[参考](https://www.cambridgeincolour.com/tutorials/gamma-correction.htm)

简而言之，伽马产生于人眼的感光特性。

人眼一般对大于当前亮度百分之一的变化才能分辨出来，显然对于低亮度区间就会更加敏感。相机用于摄制图像的感光元件对亮度的感知是线性的，但感光信息无法绝对无损地存储到图片文件中，比如八位 RGB 格式。为了减少存储时的损耗，伽马编码给低亮度区间分配了更多的空间，使编码空间不再是线性的（指数1/2.2左右）。sRGB 就是一种非线性的方案。

至于为何使用一个幂函数可以调整编码的“密度”：输出值的一个邻域内，覆盖的线性编码范围与输出值正相关，则输出值小时可以覆盖更细腻的线性空间。

为了将这种格式正常显示出来，显示屏需要进行伽马校正。CRT 显示器由于电气特性，自带了一个非线性的映射（指数 2.5 左右），其曲线非常巧合地接近伽马编码的反函数。而 LCD 等显示器只能通过添加一层电路来实现这种校正。

对于多数纹理图片，由于是艺术家基于屏幕显示效果创作的，其本身就在 sRGB 空间内。如果再次应用伽马校正会使纹理的颜色非常浅。OpenGL 可以在加载为纹理时指定 sRGB 格式来解决。但是用作参数的纹理图片一般就是字面值。注意永远不要假定输入文件的格式。

如果想要比较一下伽马对纹理的影响，可以试试直接输出纹理的颜色，再和原始图片比较。

多数（或者说所有）颜色运算都是在线性空间的假设下进行的，因此伽马相关的操作应该只出现在最初的数据读取和最后的数据输出环节。